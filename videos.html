<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Photos & Vidéos — Groupe Athlé</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0f172a; --card:#111827; --text:#e5e7eb; --accent:#22c55e;
    }
    body{margin:0;background:var(--bg);color:var(--text);
      font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Arial}
    .wrap{max-width:960px;margin:0 auto;padding:24px 24px 80px}

    /* back */
    .back{display:inline-flex;align-items:center;gap:6px;color:var(--text);
      text-decoration:none;font-size:16px;margin-bottom:16px}
    .back svg{width:20px;height:20px;stroke:#fff}

    h1{margin:0 0 4px;font-size:28px}
    .subtitle{opacity:.8;margin-bottom:18px}

    /* tabs */
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px}
    .tab{padding:8px 12px;border-radius:999px;border:1px solid #1f2937;
      background:#0b1326;color:var(--text);cursor:pointer;font-size:14px}
    .tab.active{background:var(--accent);color:#0b1326;border-color:var(--accent)}

    /* grid */
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    .card{position:relative;background:var(--card);border:1px solid #1f2937;border-radius:12px;overflow:hidden;cursor:pointer}
    .thumb{width:100%;aspect-ratio:16/9;object-fit:cover;display:block}
    .meta{padding:10px}
    .title{font-weight:700;font-size:14px;margin:0 0 4px}
    .info{font-size:12px;opacity:.8}
    .badge{position:absolute;top:8px;left:8px;font-size:12px;background:rgba(0,0,0,.5);
      color:#fff;padding:4px 6px;border-radius:8px}
    .play{position:absolute;inset:0;display:grid;place-items:center;pointer-events:none}
    .play svg{width:42px;height:42px;opacity:.9;filter:drop-shadow(0 2px 6px rgba(0,0,0,.6))}

    /* lightbox */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.75);
      display:none;align-items:center;justify-content:center;z-index:1000;padding:16px}
    .lightbox.open{display:flex}
    .viewer{position:relative;width:min(100%,1000px);max-height:90vh;background:#000;border-radius:12px;overflow:hidden}
    .viewer-inner{position:relative;background:#000}
    .viewer img{display:block;width:100%;height:auto;max-height:90vh}

    .viewer-header{position:absolute;top:8px;left:8px;right:8px;display:flex;
      justify-content:space-between;align-items:center;pointer-events:none}
    .viewer-title{color:#fff;font-size:14px;background:rgba(0,0,0,.5);padding:6px 10px;border-radius:8px;pointer-events:auto}
    .close{pointer-events:auto;background:rgba(255,255,255,.15);border:none;color:#fff;
      width:36px;height:36px;border-radius:8px;cursor:pointer}
    .nav{position:absolute;top:50%;transform:translateY(-50%);
      width:44px;height:44px;border:none;border-radius:50%;background:rgba(255,255,255,.15);
      color:#fff;cursor:pointer}
    .nav.left{left:8px}.nav.right{right:8px}

    /* Conteneur responsive 16:9 pour YouTube et vidéos MP4 */
    .video-wrapper{
      position:relative;
      width:100%;
      padding-bottom:56.25%; /* 16:9 */
      background:#000;
      max-height:90vh;
    }
    .video-wrapper iframe,
    .video-wrapper video{
      position:absolute; inset:0;
      width:100%; height:100%;
      border:0;
      background:#000;
      display:block;
      object-fit:contain; /* utile pour certaines vidéos */
    }
  </style>
</head>
<body>
  <div class="wrap">

    <a href="index.html" class="back">
      <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
      </svg>
      Retour
    </a>

    <h1>Photos & Vidéos</h1>
    <div class="subtitle">Galerie du groupe — entraînements, compétitions, coulisses</div>

    <!-- Onglets -->
    <div class="tabs">
      <button class="tab active" data-filter="all">Tous</button>
      <button class="tab" data-filter="photo">Photos</button>
      <button class="tab" data-filter="video">Vidéos</button>
    </div>

    <!-- Grille -->
    <div id="grid" class="grid"></div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" aria-modal="true" role="dialog">
    <div class="viewer">
      <button class="nav left" id="prev" title="Précédent">⟨</button>
      <div class="viewer-inner" id="viewer"></div>
      <button class="nav right" id="next" title="Suivant">⟩</button>
      <div class="viewer-header">
        <div class="viewer-title" id="viewerTitle"></div>
        <button class="close" id="close" title="Fermer">✕</button>
      </div>
    </div>
  </div>

  <script>
    // ====== Données : remplis ici ta galerie ======
    // type: 'photo' | 'youtube' | 'video'
    const ITEMS = [
      { type:'photo',   src:'https://images.unsplash.com/photo-1521417531039-96df9febb9ad?q=80&w=1200', title:'Séance poids – hiver', info:'2024 • Epinal' },
      { type:'youtube', src:'dQw4w9WgXcQ', title:'Finale Disque – Highlights', info:'2023 • France', duration:'4:12' },
      { type:'photo',   src:'https://images.unsplash.com/photo-1521417712991-4fd5c63b4d49?q=80&w=1200', title:'Stage – lancers', info:'2024 • Stage sud' },
      { type:'video',   src:'https://storage.googleapis.com/vosgeslancers/videos/example.mp4', title:'Marteau – ralenti', info:'2024 • Metz', duration:'0:26' }
    ];

    // ====== Rendu grille ======
    const $grid = document.getElementById('grid');
    const $tabs = document.querySelectorAll('.tab');
    let currentFilter = 'all';

    function getThumb(item){
      if(item.type === 'youtube'){
        const id = extractYouTubeId(item.src);
        return `https://img.youtube.com/vi/${id}/hqdefault.jpg`;
      }
      return item.thumb || item.src;
    }

    function extractYouTubeId(urlOrId){
      if(!urlOrId) return '';
      if (/^[\w-]{11}$/.test(urlOrId)) return urlOrId;
      const m = String(urlOrId).match(/[?&]v=([\w-]{11})/) || String(urlOrId).match(/youtu\.be\/([\w-]{11})/);
      return m ? m[1] : urlOrId;
    }

    function render(){
      $grid.innerHTML = '';
      ITEMS
        .filter(it =>
          currentFilter==='all'
            ? true
            : (it.type==='photo' ? 'photo' : 'video')===currentFilter || (it.type==='youtube' && currentFilter==='video')
        )
        .forEach((it, idx) => {
          const card = document.createElement('div');
          card.className = 'card';
          card.dataset.index = idx;

          const thumb = document.createElement('img');
          thumb.className = 'thumb';
          thumb.src = getThumb(it);
          thumb.alt = it.title || '';

          const meta = document.createElement('div');
          meta.className = 'meta';
          meta.innerHTML = `<div class="title">${it.title||''}</div><div class="info">${it.info||''}</div>`;

          if(it.type==='youtube' || it.type==='video'){
            const badge = document.createElement('div');
            badge.className = 'badge';
            badge.textContent = it.duration ? it.duration : 'vidéo';
            card.appendChild(badge);

            const play = document.createElement('div');
            play.className = 'play';
            play.innerHTML = `<svg viewBox="0 0 24 24" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path d="M8 5v14l11-7z"/></svg>`;
            card.appendChild(play);
          }

          card.appendChild(thumb);
          card.appendChild(meta);
          card.addEventListener('click', () => openViewer(idx));
          $grid.appendChild(card);
        });
    }

    $tabs.forEach(t=>{
      t.addEventListener('click', ()=>{
        $tabs.forEach(x=>x.classList.remove('active'));
        t.classList.add('active');
        currentFilter = t.dataset.filter;
        render();
      })
    });

    // ====== Lightbox ======
    const $lightbox = document.getElementById('lightbox');
    const $viewer   = document.getElementById('viewer');
    const $title    = document.getElementById('viewerTitle');
    const $close    = document.getElementById('close');
    const $prev     = document.getElementById('prev');
    const $next     = document.getElementById('next');
    let currentIndex = -1;

    function openViewer(index){
      currentIndex = index;
      const it = ITEMS[currentIndex];
      $viewer.innerHTML = '';
      $title.textContent = it.title || '';

      if(it.type === 'photo'){
        const img = document.createElement('img');
        img.src = it.src;
        img.alt = it.title||'';
        $viewer.appendChild(img);
      } else if(it.type === 'youtube'){
        const id = extractYouTubeId(it.src);
        const wrapper = document.createElement('div');
        wrapper.className = 'video-wrapper';
        const iframe = document.createElement('iframe');
        iframe.src = `https://www.youtube.com/embed/${id}?autoplay=1&rel=0`;
        iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
        iframe.allowFullscreen = true;
        wrapper.appendChild(iframe);
        $viewer.appendChild(wrapper);
      } else if(it.type === 'video'){
        const wrapper = document.createElement('div');
        wrapper.className = 'video-wrapper';
        const video = document.createElement('video');
        video.src = it.src;
        video.controls = true;
        video.autoplay = true;
        wrapper.appendChild(video);
        $viewer.appendChild(wrapper);
      }

      $lightbox.classList.add('open');
    }

    function closeViewer(){
      $lightbox.classList.remove('open');
      $viewer.innerHTML = '';
    }

    function filteredItems(){
      return ITEMS
        .map((it, i) => ({it, i}))
        .filter(({it}) => currentFilter==='all'
          ? true
          : (it.type==='photo' ? 'photo' : 'video')===currentFilter || (it.type==='youtube' && currentFilter==='video'));
    }

    function step(dir){
      if(currentIndex < 0) return;
      const list = filteredItems();
      const pos = list.findIndex(x => x.i === currentIndex);
      const nextPos = (pos + dir + list.length) % list.length;
      openViewer(list[nextPos].i);
    }

    $close.addEventListener('click', closeViewer);
    $lightbox.addEventListener('click', (e)=>{ if(e.target === $lightbox) closeViewer(); });
    $prev.addEventListener('click', ()=>step(-1));
    $next.addEventListener('click', ()=>step(1));
    document.addEventListener('keydown', (e)=>{
      if(!$lightbox.classList.contains('open')) return;
      if(e.key==='Escape') closeViewer();
      if(e.key==='ArrowLeft') step(-1);
      if(e.key==='ArrowRight') step(1);
    });

    // init
    render();
  </script>
</body>
</html>
