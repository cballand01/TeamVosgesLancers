<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Plans d’entraînement — Athlètes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0f172a; --card:#111827; --surface:#0b1326;
      --text:#e5e7eb; --muted:#94a3b8; --line:#1f2937; --accent:#22c55e;
      --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Arial}
    .wrap{max-width:1000px;margin:0 auto;padding:24px 16px 120px}

    /* Header */
    .back{display:inline-flex;align-items:center;gap:6px;color:var(--text);text-decoration:none;font-size:16px;margin-bottom:12px}
    .back svg{width:20px;height:20px;stroke:#fff}
    h1{margin:0 0 6px;font-size:28px;line-height:1.15;font-weight:800;letter-spacing:.2px;position:relative;padding-bottom:8px}
    h1::after{content:"";position:absolute;left:0;bottom:0;width:88px;height:3px;background:var(--accent);border-radius:999px;
      box-shadow:0 0 0 1px rgba(34,197,94,.15), 0 8px 18px rgba(34,197,94,.18)}
    .subtitle{opacity:.85;color:var(--muted);margin:6px 0 12px}

    /* Header actions (Admin + Ajouter) */
    .head-actions{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:8px 0 16px}
    .pill{
      padding:8px 12px;border-radius:999px;border:1px solid var(--line);
      background:#0b1326;color:var(--text);cursor:pointer;font-size:13px
    }
    .pill.primary{background:var(--accent);color:#0b1326;border-color:var(--accent);font-weight:700}
    [data-admin]{display:none} /* masqué par défaut, visible si admin */

    /* ====== ATHLÈTES (mobile: liste verticale) ====== */
    .ath-list{display:grid;gap:10px}
    a.ath-card{
      position:relative;display:flex;gap:12px;align-items:center;
      padding:12px 14px;background:var(--card);border:1px solid var(--line);border-radius:16px;
      text-decoration:none;color:var(--text);
    }
    a.ath-card::before{content:"";position:absolute;left:0;top:0;bottom:0;width:6px;background:var(--accent);border-radius:16px 0 0 16px;opacity:.9}
    .ath-avatar{width:72px;height:72px;border-radius:12px;overflow:hidden;border:1px solid #334155;background:#000;flex:0 0 72px}
    .ath-avatar img{width:100%;height:100%;object-fit:cover}
    .ath-txt{min-width:0;display:flex;flex-direction:column;gap:4px}
    .ath-name{font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .ath-meta{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .ath-chevron{margin-left:auto;color:#cbd5e1;font-size:20px;opacity:.85}

    /* ====== Exercices (mobile: liste) ====== */
    .section-title{margin:40px 0 8px;font-weight:700}
    .section-line{height:1px;background:#243043;border:none;margin:0 0 14px;opacity:.6}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .search{flex:1;min-width:180px;background:#0b1326;border:1px solid var(--line);border-radius:10px;color:var(--text);padding:10px 12px}
    .filter{padding:8px 12px;border-radius:999px;border:1px solid var(--line);background:#0b1326;color:var(--text);cursor:pointer;font-size:13px}
    .filter.active{background:var(--accent);color:#0b1326;border-color:var(--accent)}

    .ex-list{display:grid;gap:10px}
    .ex-row{
      display:flex;gap:14px;align-items:center;
      background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px 16px;
    }
    .ex-thumb{width:120px;height:68px;flex:0 0 120px;border-radius:10px;overflow:hidden;background:#000}
    .ex-thumb img{width:100%;height:100%;object-fit:cover}
    .ex-txt{min-width:0}
    .ex-title{font-weight:700;font-size:14px;white-space:normal}
    .ex-info{font-size:12px;color:var(--muted);margin-top:2px}
    .info-btn{
      margin-left:auto;border:1px solid var(--line);background:transparent;color:var(--text);
      border-radius:10px;padding:8px 14px;cursor:pointer;flex-shrink:0;
      transition: border-color .2s, transform .08s;
    }
    .info-btn:hover{border-color:var(--accent)}
    .info-btn:active{transform:scale(.98)}

    /* ====== Desktop adaptations ====== */
    @media (min-width:760px){
      .wrap{padding:24px 24px 120px}
      .ath-list{grid-template-columns:repeat(3,1fr)}
      .ath-avatar{width:64px;height:64px;flex:0 0 64px}

      .ex-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
      .ex-row{display:block;padding:0;overflow:hidden}
      .ex-thumb{width:100%;height:auto;aspect-ratio:16/9;border-radius:12px 12px 0 0}
      .ex-thumb img{border-bottom:1px solid var(--line)}
      .ex-txt{padding:10px 12px}
      .ex-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
      .info-btn{margin:8px 12px 12px auto;display:block}
    }

    /* Lightbox */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center;z-index:1000;padding:16px}
    .lightbox.open{display:flex}
    .viewer{position:relative;width:min(100%,900px);max-height:90vh;background:#000;border-radius:12px;overflow:hidden}
    .viewer img{display:block;width:100%;height:auto}
    .viewer-head{position:absolute;top:8px;left:8px;right:8px;display:flex;justify-content:space-between;align-items:center}
    .viewer-title{color:#fff;font-size:14px;background:rgba(0,0,0,.5);padding:6px 10px;border-radius:8px}
    .close{background:rgba(255,255,255,.15);border:none;color:#fff;width:36px;height:36px;border-radius:8px;cursor:pointer}

    /* Sheets (login + add exercise) */
    .sheet-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);display:none;align-items:flex-end;z-index:1100}
    .sheet{width:100%;max-width:1000px;margin:0 auto;background:var(--card);
      border-top-left-radius:16px;border-top-right-radius:16px;border:1px solid var(--line);
      border-bottom:none;padding:14px 16px 16px;animation:slideup .18s ease-out;max-height:85vh;overflow:auto}
    @keyframes slideup{from{transform:translateY(12px);opacity:0}to{transform:translateY(0);opacity:1}}
    .row{display:flex;gap:8px;margin:8px 0;align-items:center}
    .row label{flex:0 0 130px;opacity:.9}
    .row input,.row select,.row textarea{flex:1;background:#0b1326;border:1px solid var(--line);border-radius:8px;color:var(--text);padding:10px}
    .actions{display:flex;gap:8px;justify-content:flex-start;margin-top:8px}
    .btn{border:1px solid var(--line);border-radius:10px;background:#0b1326;color:#e5e7eb;padding:8px 12px;cursor:pointer}
    .btn.ghost{background:transparent}
    .small{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <a href="index.html" class="back">
      <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/></svg>
      Retour
    </a>

    <h1>Plans d’entraînement</h1>
    <p class="subtitle">Choisis un athlète pour ouvrir son plan • Explore les exercices illustrés</p>

    <!-- Header actions -->
    <div class="head-actions">
      <button id="btnAdmin" class="pill">Se connecter</button>
      <button id="btnAddExo" class="pill primary" data-admin>＋ Ajouter un exercice</button>
    </div>

    <!-- Liste athlètes -->
    <div id="athList" class="ath-list"></div>

    <div class="section-title">Exercices illustrés</div>
    <hr class="section-line" />

    <!-- Barre outils -->
    <div class="toolbar">
      <input id="q" class="search" placeholder="Recherche : squat, épaulé, frappes…">
      <button class="filter active" data-fam="all">Tous</button>
      <button class="filter" data-fam="muscu">Musculation</button>
      <button class="filter" data-fam="halter">Haltérophilie</button>
      <button class="filter" data-fam="corps">Poids du corps</button>
      <button class="filter" data-fam="ppg">PPG</button>
      <button class="filter" data-fam="spec">Spécifique</button>
    </div>

    <!-- Liste / grille d’exos -->
    <div id="exList" class="ex-list"></div>
  </div>

  <!-- Lightbox (illustrations) -->
  <div id="lb" class="lightbox">
    <div class="viewer">
      <div class="viewer-head">
        <div id="lbTitle" class="viewer-title"></div>
        <button id="lbClose" class="close">✕</button>
      </div>
      <img id="lbImg" alt="">
    </div>
  </div>

  <!-- Sheet: Connexion admin -->
  <div id="loginSheet" class="sheet-backdrop">
    <div class="sheet">
      <h3 style="margin:4px 0 8px">Connexion admin</h3>
      <div class="row"><label>Mot de passe</label><input id="adminPwd" type="password" placeholder="••••••" autocomplete="current-password"></div>
      <div class="actions">
        <button class="btn ghost" id="loginCancel">Annuler</button>
        <button class="btn" id="loginSubmit">Se connecter</button>
      </div>
      <div id="loginMsg" class="small" style="margin-top:6px"></div>
    </div>
  </div>

  <!-- Sheet: Ajouter un exercice (admin only) -->
  <div id="addExoSheet" class="sheet-backdrop">
    <div class="sheet">
      <h3 style="margin:4px 0 8px">Ajouter un exercice</h3>
      <div class="row"><label>Nom</label><input id="exName" placeholder="ex: Développé couché"></div>
      <div class="row">
        <label>Famille</label>
        <select id="exFam">
          <option value="muscu">Musculation</option>
          <option value="halter">Haltérophilie</option>
          <option value="corps">Poids du corps</option>
          <option value="ppg">PPG</option>
          <option value="spec">Spécifique</option>
        </select>
      </div>
      <div class="row">
        <label>Type de mesure</label>
        <select id="exMeasure">
          <option value="sets_reps_kg">Séries + Rép + Kg</option>
          <option value="sets_reps">Séries + Rép</option>
          <option value="reps">Répétitions</option>
          <option value="weight_only">Poids (Kg)</option>
          <option value="time">Temps</option>
          <option value="distance">Distance</option>
          <option value="technique">Technique / Quali.</option>
        </select>
      </div>
      <div class="row"><label>Miniature</label><input id="exThumb" placeholder="URL image miniature"></div>
      <div class="row"><label>Illustration</label><input id="exFull" placeholder="URL image/vidéo (optionnel)"></div>
      <div class="row"><label>Tags</label><input id="exTags" placeholder="ex: pousser, poitrine"></div>
      <div class="row"><label>Note</label><input id="exNote" placeholder="ex: Pectoraux • Triceps"></div>

      <div class="actions">
        <button class="btn ghost" id="addExoCancel">Annuler</button>
        <button class="btn" id="addExoSave">Enregistrer</button>
      </div>
      <div id="addExoMsg" class="small" style="margin-top:6px"></div>
    </div>
  </div>

  <script>
    /* ====== API base ====== */
    const API = 'https://script.google.com/macros/s/YOUR-APPS-SCRIPT/exec'; // ← remplace

    /* ====== Auth front (token en localStorage) ====== */
    const btnAdmin = document.getElementById('btnAdmin');
    const adminSheet = document.getElementById('loginSheet');
    const adminPwd = document.getElementById('adminPwd');
    const loginMsg = document.getElementById('loginMsg');

    const FRONT_PASSWORD = "CH48ba84&*"; // à changer évidemment

    function authToken(){ return localStorage.getItem('authToken') || ''; }
    function isAdmin(){ return !!authToken(); }
    function authHeader(){
      const t = authToken();
      return t ? { 'Authorization':'Bearer '+t } : {};
    }
    function openLogin(){ adminSheet.style.display='flex'; loginMsg.textContent=''; adminPwd.value=''; adminPwd.focus(); }
    function closeLogin(){ adminSheet.style.display='none'; loginMsg.textContent=''; adminPwd.value=''; }
    async function doLogin(){
      if (adminPwd.value === FRONT_PASSWORD) {
        // Simule un token
        localStorage.setItem('authToken', 'local-dev-token');
        loginMsg.textContent = 'Connecté !';
        setTimeout(()=>{ closeLogin(); refreshAdminUI(); }, 300);
      } else {
        loginMsg.textContent = 'Mot de passe invalide.';
      }
    }
    function logout(){
      localStorage.removeItem('authToken');
      refreshAdminUI();
    }
    function refreshAdminUI(){
      const adminBits = document.querySelectorAll('[data-admin]');
      if(isAdmin()){
        btnAdmin.textContent = 'Admin ✅ (Déconnexion)';
        btnAdmin.onclick = logout;
        adminBits.forEach(x=>x.style.display='');
      }else{
        btnAdmin.textContent = 'Administrateur';
        btnAdmin.onclick = openLogin;
        adminBits.forEach(x=>x.style.display='none');
      }
    }
    document.getElementById('loginCancel').onclick = closeLogin;
    document.getElementById('loginSubmit').onclick = doLogin;
    adminSheet.addEventListener('click', e=>{ if(e.target===adminSheet) closeLogin(); });

    /* ====== Add Exercise sheet (admin) ====== */
    const addExoBtn = document.getElementById('btnAddExo');
    const addExoSheet = document.getElementById('addExoSheet');
    const addExoMsg = document.getElementById('addExoMsg');
    const exName = document.getElementById('exName');
    const exFam = document.getElementById('exFam');
    const exMeasure = document.getElementById('exMeasure');
    const exThumb = document.getElementById('exThumb');
    const exFull = document.getElementById('exFull');
    const exTags = document.getElementById('exTags');
    const exNote = document.getElementById('exNote');

    function openAddExo(){
      if(!isAdmin()){ openLogin(); return; }
      addExoMsg.textContent=''; exName.value=''; exThumb.value=''; exFull.value='';
      exTags.value=''; exNote.value='';
      exFam.value='muscu'; exMeasure.value='sets_reps_kg';
      addExoSheet.style.display='flex';
    }
    function closeAddExo(){ addExoSheet.style.display='none'; addExoMsg.textContent=''; }
    document.getElementById('addExoCancel').onclick = closeAddExo;
    addExoSheet.addEventListener('click', e=>{ if(e.target===addExoSheet) closeAddExo(); });
    addExoBtn.onclick = openAddExo;

    async function createExercise(payload){
      const r = await fetch(API+'?resource=exercises&action=create', {
        method:'POST',
        headers:{ 'Content-Type':'application/json', ...authHeader() },
        body: JSON.stringify(payload)
      });
      return r.json();
    }

    document.getElementById('addExoSave').onclick = async ()=>{
      const name = exName.value.trim();
      const fam  = exFam.value;
      const measure_mode = exMeasure.value;
      const thumb = exThumb.value.trim();
      const full  = exFull.value.trim();
      const tags  = exTags.value.split(',').map(s=>s.trim()).filter(Boolean);
      const note  = exNote.value.trim();

      if(!name){ addExoMsg.textContent='Le nom est obligatoire.'; return; }
      addExoMsg.textContent='Enregistrement…';
      try{
        const payload = { name, family:fam, measure_mode, media_thumb:thumb, media_full:full, tags, note };
        const res = await createExercise(payload);
        if(res && res.ok){
          addExoMsg.textContent = 'Ajouté !';
          // Option UX : injecter localement pour voir l’exo tout de suite
          EXOS.unshift({
            id: res.item?.id || (name.toLowerCase().replace(/\s+/g,'_')+'_'+Date.now()),
            fam, name, thumb: thumb || P_MUSC, note
          });
          renderExos();
          setTimeout(closeAddExo, 350);
        }else{
          addExoMsg.textContent = 'Erreur: ' + (res && res.error ? res.error : 'API');
        }
      }catch(e){
        addExoMsg.textContent = 'Erreur réseau.';
      }
    };

    /* ====== Données mock (athlètes + exos de départ) ====== */
    const ATHLETES = [
      { id:'charles', name:'Charles Balland', photo:'./images/Charles.png', club:'PCA • Senior' },
      { id:'daniel',  name:'Daniel Balland',  photo:'./images/Daniel.png',  club:'AVEC • Légende' },
      { id:'elano',   name:'Elano Thiébaut',  photo:'./images/Elano.png',   club:'AVEC • Jeune' },
      { id:'fabio',   name:'Fabio Thiébaut',  photo:'./images/fabio.png',   club:'AVEC • Jeune' },
      { id:'fanny',   name:'Fanny T.-Lacôte', photo:'./images/fanny.png',   club:'AVEC • Senior' },
      { id:'franck',  name:'Franck Mathieu',  photo:'./images/franck.jpg',  club:'AVEC • Master' },
      { id:'laura',   name:'Laura Didier',    photo:'./images/Laura.png',   club:'AVEC • Senior' },
      { id:'maxime',  name:'Maxime Balland',  photo:'./images/maxime.jpg',  club:'MBA • Senior' },
      { id:'rosie',   name:'Rosie Prêtre',    photo:'./images/Rosie.png',   club:'AVEC • Master' },
      { id:'yanis',   name:'Yanis Boulayoune',photo:'./images/Yanis.png',   club:'AVEC • Senior' },
    ];

    const P_MUSC = 'https://i.imgur.com/5b0q7hS.jpeg';
    const P_POST = 'https://i.imgur.com/y1F7pF2.jpeg';
    const P_SPEC = 'https://i.imgur.com/8YBf1bT.jpeg';
    const P_DISC = 'https://i.imgur.com/3YJXb7a.jpeg';
    const P_SN   = 'https://i.imgur.com/0dXw0k2.jpeg';
    const P_CJ   = 'https://i.imgur.com/8v9M3Kj.jpeg';

    // Grosse base d’exercices (à compléter/remplacer)
    const EXOS = [
      // Musculation — Squats
      { id:'squat_arriere_complet', fam:'muscu', name:'Squat arrière complet', thumb:'./images/Exercices/squatComplet.jpeg', note:'Quadriceps • Force' },
      { id:'squat_arriere_demi', fam:'muscu', name:'Demi-squat arrière', thumb:P_MUSC, note:'Quadriceps • Force' },
      { id:'squat_avant', fam:'muscu', name:'Squat avant (front squat)', thumb:'./images/Exercices/front-squat.jpg', note:'Quadriceps • Gainage' },
      { id:'overhead_squat', fam:'muscu', name:'Overhead squat', thumb:'./images/Exercices/overhead-squat.jpg', note:'Mobilité • Stability' },
      { id:'squat_bulgare', fam:'muscu', name:'Squat Bulgare', thumb:'./images/Exercices/SquatBulgare.png', note:'Mobilité • Stability' },

      // Musculation — Poussé
      { id:'dev_couche', fam:'muscu', name:'Développé couché', thumb:'./images/Exercices/Bench1.png', note:'Pectoraux • Triceps' },
      { id:'dev_couche_incline', fam:'muscu', name:'Développé couché incliné', thumb:'./images/Exercices/BenchInc1.png', note:'Haut de pectoraux' },
      { id:'dev_militaire', fam:'muscu', name:'Développé militaire (strict press)', thumb:'./images/Exercices/devMili.jpg', note:'Épaules • Tronc' },
      { id:'dev_epaule_halteres', fam:'muscu', name:'Développé épaules haltères', thumb:P_MUSC, note:'Stabilité • Unilatéral' },
      { id:'push_press', fam:'muscu', name:'Push press', thumb:P_MUSC, note:'Transfert de force' },

      // Musculation — Tirage / Chaîne post
      { id:'souleve_terre', fam:'muscu', name:'Soulevé de terre', thumb:'./images/Exercices/sdt.jpg', note:'Chaîne postérieure' },
      { id:'souleve_terre_jt', fam:'muscu', name:'Soulevé de terre jambes tendues', thumb:'./images/Exercices/sdtjambetendu.webp', note:'Ischios • Fessiers' },
      { id:'row_barre', fam:'muscu', name:'Rowing barre', thumb:'./images/Exercices/rowing-barre-buste-penche-exercice.jpg', note:'Dos • Scapulas' },
      { id:'row_un_lateral', fam:'muscu', name:'Rowing unilatéral haltère', thumb:P_POST, note:'Dos • Antidéséquilibre' },
      { id:'tirage', fam:'muscu', name:'Tirage couché', thumb:P_MUSC, note:'Dos • ...' },
      { id:'hip_thrust', fam:'muscu', name:'Hip Thrust', thumb:'./images/Exercices/HipThrust.png', note:'Fessiers • Puissance' },
      { id:'curl', fam:'muscu', name:'Biceps', thumb:'./images/Exercices/CurlBarre.png', note:'Ischios • Lombaires' },
      { id:'good_morning', fam:'muscu', name:'Good Morning', thumb:P_MUSC, note:'Ischios • Lombaires' },
      { id:'elev_lat', fam:'muscu', name:'Elévation latérale', thumb:'./images/Exercices/ElevLat.png', note:'Ischios • Lombaires' },
      { id:'triceps', fam:'muscu', name:'Triceps', thumb:'./images/Exercices/Triceps.png', note:'Ischios • Lombaires' },
      { id:'tirage_poit', fam:'muscu', name:'Tirage poitrine', thumb:'./images/Exercices/tiragePoit.png', note:'Ischios • Lombaires' },

      // Haltérophilie
      { id:'snatch', fam:'halter', name:'Arraché (Snatch)', thumb:'./images/Exercices/snatch.jpg', note:'Explosivité • Technique' },
      { id:'power_snatch', fam:'halter', name:'Arraché des hanches', thumb:P_SN, note:'Vitesse • Coordination' },
      { id:'clean_jerk', fam:'halter', name:'Épaulé-jeté (Clean & Jerk)', thumb:'./images/Exercices/CleanJerk.jpg', note:'Puissance' },
      { id:'clean', fam:'halter', name:'Épaulé (Clean)', thumb:'./images/Exercices/Clean.jpg', note:'Triple extension' },
      { id:'hang_clean', fam:'halter', name:'Épaulé des genoux', thumb:P_CJ, note:'Travail du 2e tirage' },
      { id:'jerk', fam:'halter', name:'Jeté (Jerk)', thumb:P_CJ, note:'Puissance épaule/hanches' },
      { id:'high_pull', fam:'halter', name:'High Pull (tirage haut)', thumb:P_CJ, note:'Puissance • Trajectoire' },
      { id:'shrug_jump', fam:'halter', name:'Shrug jump', thumb:P_CJ, note:'Synchronisation' },

      // Poids du corps
      { id:'pompes', fam:'corps', name:'Pompes', thumb:'./images/Exercices/pompes.png', note:'Pectoraux • Triceps' },
      { id:'dips', fam:'corps', name:'Dips', thumb:'./images/Exercices/dips.png', note:'Triceps • Pectoraux' },
      { id:'tractions_pronation', fam:'corps', name:'Tractions pronation', thumb:P_CJ, note:'Dos • Biceps' },
      { id:'tractions_suppination', fam:'corps', name:'Tractions supination', thumb:P_CJ, note:'Biceps • Dos' },
      { id:'abdos_crunch', fam:'corps', name:'Abdominaux — Crunch', thumb:P_CJ, note:'Grand droit' },
      { id:'gainage_planche', fam:'corps', name:'Gainage — Planche', thumb:P_CJ, note:'Core • Anti-extension' },
      { id:'gainage_cote', fam:'corps', name:'Gainage — Côté', thumb:P_CJ, note:'Obliques • Anti-inclinaison' },
      { id:'burpees', fam:'corps', name:'Burpees', thumb:'./images/burpees.png', note:'Cardio • Explosivité' },
      { id:'fentes_saut', fam:'corps', name:'Fentes sautées', thumb:P_CJ, note:'Plyo • Jambes' },

      // PPG (Prépa Physique Générale)
      { id:'ppg_haies', fam:'ppg', name:'PPG — Sauts de haies', thumb:P_SPEC, note:'Coordination • Plyo' },
      { id:'ppg_montes_genoux', fam:'ppg', name:'PPG — Montées de genoux', thumb:P_SPEC, note:'Fréquence • Posture' },
      { id:'ppg_talons_fesses', fam:'ppg', name:'PPG — Talons-fesses', thumb:P_SPEC, note:'Mobilité genou' },
      { id:'ppg_multibonds', fam:'ppg', name:'PPG — Multibonds', thumb:P_SPEC, note:'Plyométrie' },
      { id:'ppg_sauts_corde', fam:'ppg', name:'PPG — Corde à sauter', thumb:P_SPEC, note:'Rythme • Chevilles' },
      { id:'ppg_cote_cote', fam:'ppg', name:'PPG — Appuis latéraux', thumb:P_SPEC, note:'Réactivité • Appuis' },

      // Spécifiques lancers (ex. disque)
      { id:'disq_frappes_mur', fam:'spec', name:'Disque — Frappes au mur', thumb:P_SPEC, note:'Rythme • Posture' },
      { id:'disq_deplacements', fam:'spec', name:'Disque — Déplacements (rotations)', thumb:P_DISC, note:'Rythme • Posture' },
      { id:'disq_stand_throw', fam:'spec', name:'Disque — Stand throw', thumb:P_DISC, note:'Rythme • Posture' },
      { id:'disq_south_african', fam:'spec', name:'Disque — South African', thumb:P_DISC, note:'Rythme • Posture' },
      { id:'disq_full_throw', fam:'spec', name:'Disque — Lancer complet', thumb:P_DISC, note:'Rythme • Posture' },

      // Spécifiques poids
      { id:'poids_sansélan', fam:'spec', name:'Poids — Sans élan', thumb:'./images/Exercices/Poids/Sans-élan.png', note:'Rythme • Posture' },
      { id:'poids_glide', fam:'spec', name:'Poids — Jet complet', thumb:'./images/Exercices/Poids/complet.png', note:'Rythme • Posture' },
      { id:'poids_robertson', fam:'spec', name:'Poids — Robertson', thumb:'./images/Exercices/Poids/Robertson.png', note:'Rythme • Posture' },
      { id:'poids_mimes', fam:'spec', name:'Poids — Mimes simples', thumb:'./images/Exercices/Poids/mimes.png', note:'Rythme • Posture' },
      { id:'poids_piedgauche', fam:'spec', name:'Poids — Mimes percussion butoire', thumb:'./images/Exercices/Poids/frappe.png', note:'Rythme • Posture' },
      { id:'poids_elastique', fam:'spec', name:'Poids — Ramener élastique', thumb:'./images/Exercices/Poids/ramene_elastique.png', note:'Rythme • Posture' },
      { id:'poids_ramenerlancer', fam:'spec', name:'Poids — Ramener-Lancer', thumb:'./images/Exercices/Poids/ramenéLance.png', note:'Rythme • Posture' },
      { id:'poids_mimeslouds', fam:'spec', name:'Poids — Mimes lestés', thumb:'./images/Exercices/Poids/mimes_10kg.png', note:'Rythme • Posture' },
      { id:'poids_fentes', fam:'spec', name:'Poids — Fentes Dynamiques', thumb:'./images/Exercices/Poids/fentes_rapide.png', note:'Rythme • Posture' },
      { id:'poids_mimes_enchaine', fam:'spec', name:'Poids — Mimes enchainés', thumb:'./images/Exercices/Poids/déplacement_enchainé.png', note:'Rythme • Posture' },
      { id:'poids_mimes_finale', fam:'spec', name:'Poids — Mimes finale avec barre', thumb:'./images/Exercices/Poids/déplacement_enchainé.png', note:'Rythme • Posture' },
      { id:'poids_frappes', fam:'spec', name:'Poids — Frappes au mur (medecinBall)', thumb:'./images/Exercices/Poids/frappe mur.png', note:'Rythme • Posture' },
    ];

    /* ====== Athlètes (cartes cliquables) ====== */
    const athList = document.getElementById('athList');
    ATHLETES.forEach(a=>{
      const card = document.createElement('a');
      card.className = 'ath-card';
      card.href = `athlete.html?id=${encodeURIComponent(a.id)}`;
      card.innerHTML = `
        <div class="ath-avatar"><img src="${a.photo}" alt="${a.name}"></div>
        <div class="ath-txt">
          <div class="ath-name">${a.name}</div>
          <div class="ath-meta">${a.club||''}</div>
        </div>
        <div class="ath-chevron" aria-hidden="true">›</div>
      `;
      athList.appendChild(card);
    });

    /* ====== Explorateur d’exos ====== */
    let fam = 'all';
    let q = '';
    const filters = document.querySelectorAll('.filter');
    const exList = document.getElementById('exList');
    const qInput = document.getElementById('q');

    filters.forEach(p=>{
      p.addEventListener('click', ()=>{
        filters.forEach(x=>x.classList.remove('active'));
        p.classList.add('active');
        fam = p.dataset.fam;
        renderExos();
      });
    });
    qInput.addEventListener('input', ()=>{ q = qInput.value.toLowerCase(); renderExos(); });

    function labelFam(f){
      return f==='muscu' ? 'Musculation'
           : f==='halter'? 'Haltérophilie'
           : f==='corps' ? 'Poids du corps'
           : f==='ppg'   ? 'PPG'
           : f==='spec'  ? 'Spécifique'
           : 'Autre';
    }

    function renderExos(){
      exList.innerHTML = '';
      EXOS
        .filter(x=> fam==='all' ? true : x.fam===fam)
        .filter(x=> !q || x.name.toLowerCase().includes(q))
        .forEach(x=>{
          const row = document.createElement('div');
          row.className = 'ex-row';
          row.innerHTML = `
            <div class="ex-thumb"><img src="${x.thumb}" alt=""></div>
            <div class="ex-txt">
              <div class="ex-title">${x.name}</div>
              <div class="ex-info">${labelFam(x.fam)}${x.note ? ' • ' + x.note : ''}</div>
            </div>
            <button class="info-btn" data-id="${x.id}" title="Voir l’illustration">i</button>
          `;
          row.querySelector('.info-btn').addEventListener('click', ()=> openLB(x));
          exList.appendChild(row);
        });
    }

    /* Lightbox */
    const lb = document.getElementById('lb');
    const lbImg = document.getElementById('lbImg');
    const lbTitle = document.getElementById('lbTitle');
    document.getElementById('lbClose').onclick = ()=> lb.classList.remove('open');
    lb.addEventListener('click', e=>{ if(e.target===lb) lb.classList.remove('open'); });
    function openLB(ex){
      lbImg.src = ex.thumb;
      lbTitle.textContent = `${ex.name} • ${labelFam(ex.fam)}${ex.note?' — '+ex.note:''}`;
      lb.classList.add('open');
    }

    /* Boot */
    renderExos();
    refreshAdminUI();
  </script>
</body>
</html>
